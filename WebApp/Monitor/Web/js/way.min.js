!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.way=b()}(this,function(){"use strict";var a,b,e,f,g,h,i,j,k,l,n,o,p,q,r,t,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,c="way",d=function(){this._watchers={},this._watchersAll={}};return d.prototype.constructor=d,d.prototype.watchAll=function(a){this._watchersAll=this._watchersAll||[],o.contains(this._watchersAll,a)||this._watchersAll.push(a)},d.prototype.watch=function(a,b){this._watchers||(this._watchers={}),this._watchers[a]=this._watchers[a]||[],this._watchers[a].push(b)},d.prototype.findWatcherDeps=function(a){var b=[],c=o.keys(this._watchers);return c.forEach(function(c){g(a,c)&&b.push(c)}),b},d.prototype.emitChange=function(a){var b,c;this._watchers||(this._watchers={}),b=this,c=b.findWatcherDeps(a),c.forEach(function(a){b._watchers[a]&&b._watchers[a].forEach(function(c){c.apply(b,[b.get(a)])})}),b._watchersAll&&o.isArray(b._watchersAll)&&b._watchersAll.forEach(function(c){o.isFunction(c)&&c.apply(b,[a,b.get(a)])})},e=function(){this.data={},this._bindings={},this.options={persistent:!0,timeoutInput:50,timeoutDOM:500}},e.prototype=Object.create(d.prototype),e.constructor=e,e.prototype.dom=function(a){return this._element=b.dom(a).get(0),this},e.prototype.toStorage=function(a,b){var c=this,b=b||c._element,a=a||c.dom(b).getOptions(),d=c.dom(b).toJSON(a),e=c.dom(b).scope(),f=e?e+"."+a.data:a.data;return a.readonly?!1:(c.set(f,d,a),void 0)},e.prototype.toJSON=function(a,b){var c=this,b=b||c._element,d=c.dom(b).getValue(),a=a||c.dom(b).getOptions();return o.isArray(a.pick)&&(d=k(d,a.pick,!0)),o.isArray(a.omit)&&(d=k(d,a.omit,!1)),d},e.prototype.fromStorage=function(a,b){var d,e,f,c=this;return b=b||c._element,a=a||c.dom(b).getOptions(),a.writeonly?!1:(d=c.dom(b).scope(),e=d?d+"."+a.data:a.data,f=c.get(e),c.dom(b).fromJSON(f,a),void 0)},e.prototype.fromJSON=function(a,b,c){var e,d=this;return c=c||d._element,b=b||d.dom(c).getOptions(),b.writeonly?!1:(o.isObject(a)&&(o.isArray(b.pick)&&(a=k(a,b.pick,!0)),o.isArray(b.omit)&&(a=k(a,b.omit,!1)),e=o.isObject(d.dom(c).toJSON())?d.dom(c).toJSON():{},a=o.extend(e,a)),b.json&&(a=D.isStringified(a)?a:D.prettyprint(a)),d.dom(c).setValue(a,b),void 0)},e.prototype.getValue=function(a){var d,e,f,g,c=this;return a=a||c._element,d={SELECT:function(){return b.dom(a).val()},INPUT:function(){var c=b.dom(a).type();return o.contains(["text","password"],c)?b.dom(a).val():o.contains(["checkbox","radio"],c)?b.dom(a).prop("checked")?b.dom(a).val():null:void 0},TEXTAREA:function(){return b.dom(a).val()}},e=function(){return b.dom(a).html()},f=b.dom(a).get(0).tagName,g=d[f]||e,g()},e.prototype._transforms={uppercase:function(a){return o.isString(a)?a.toUpperCase():a},lowercase:function(a){return o.isString(a)?a.toLowerCase():a},reverse:function(a){return a&&a.split&&o.isFunction(a.split)?a.split("").reverse().join(""):a}},e.prototype.registerTransform=function(a,b){var c=this;o.isFunction(b)&&(c._transforms[a]=b)},e.prototype.setValue=function(a,c,d){var f,g,h,i,e=this;d=d||e._element,c=c||e.dom(d).getOptions(),c.transform=c.transform||[],c.transform.forEach(function(b){var c=e._transforms[b]||function(a){return a};a=c(a)}),f={SELECT:function(a){b.dom(d).val(a)},INPUT:function(a){o.isString(a)||(a=JSON.stringify(a));var c=b.dom(d).get(0).type;o.contains(["text","password"],c)&&b.dom(d).val(a||""),o.contains(["checkbox","radio"],c)&&(a===b.dom(d).val()?b.dom(d).prop("checked",!0):b.dom(d).prop("checked",!1))},TEXTAREA:function(a){o.isString(a)||(a=JSON.stringify(a)),b.dom(d).val(a||"")},PRE:function(a){c.html?b.dom(d).html(a):b.dom(d).text(a)},IMG:function(a){if(!a)return a=c.default||"",b.dom(d).attr("src",a),!1;var e=function(a,c){b.dom(d).addClass("way-loading"),b.dom("img",{src:a,onerror:function(){c(!1)},onload:function(){c(!0)}})};e(a,function(e){b.dom(d).removeClass("way-loading"),e?b.dom(d).removeClass("way-error").addClass("way-success"):(a?b.dom(d).addClass("way-error"):b.dom(d).removeClass("way-error").removeClass("way-success"),a=c.default||""),b.dom(d).attr("src",a)})}},g=function(a){c.html?b.dom(d).html(a):b.dom(d).text(a)},h=b.dom(d).get(0).tagName,i=f[h]||g,i(a)},e.prototype.setDefault=function(a,b,c){var d=this,c=c||d._element,a=a||!1,b=b?o.extend(d.dom(c).getOptions(),b):d.dom(c).getOptions();return b.default?(a?d.set(b.data,b.default,b):d.dom(c).setValue(b.default,b),void 0):!1},e.prototype.setDefaults=function(){var f,g,h,i,j,a=this,d="["+c+"-default]",e=b.dom(d).get();for(f in e)g=e[f],h=a.dom(g).getOptions(),i=h.data||null,j=i?a.get(i):null,j||a.dom(g).setDefault()},e.prototype.registerBindings=function(){var e,f,g,h,i,a=this,d="["+c+"-data]";a._bindings={},e=b.dom(d).get();for(f in e)g=e[f],h=a.dom(g).getOptions(),i=a.dom(g).scope(),d=i?i+"."+h.data:h.data,a._bindings[d]=a._bindings[d]||[],o.contains(a._bindings[d],b.dom(g).get(0))||a._bindings[d].push(b.dom(g).get(0))},e.prototype.updateBindings=function(a){var d,c=this;c._bindings=c._bindings||{},d=l(c._bindings,a),d.forEach(function(a){var d=b.dom(a).get(0)===b.dom(":focus").get(0)?!0:!1;d||c.dom(a).fromStorage()}),c._bindings["__all__"]&&c._bindings["__all__"].forEach(function(a){c.dom(a).fromJSON(c.data)})},e.prototype.registerRepeats=function(){var e,f,g,h,i,j,k,a=this,d="["+c+"-repeat]";a._repeats=a._repeats||{},a._repeatsCount=a._repeatsCount||0,e=b.dom(d).get();for(f in e)g=e[f],h=a.dom(g).getOptions(),a._repeats[h.repeat]=a._repeats[h.repeat]||[],i=c+'-repeat-wrapper="'+a._repeatsCount+'"',j=b.dom(g).parent("["+i+"]"),j.length||(a._repeats[h.repeat].push({id:a._repeatsCount,element:b.dom(g).clone(!0).removeAttr(c+"-repeat").removeAttr(c+"-filter").get(0),selector:h.repeat,filter:h.filter}),k=document.createElement("div"),b.dom(k).attr(c+"-repeat-wrapper",a._repeatsCount),b.dom(k).attr(c+"-scope",h.repeat),h.filter&&b.dom(k).attr(c+"-filter",h.filter),b.dom(g).replaceWith(k),a.updateRepeats(h.repeat),a._repeatsCount++)},e.prototype.updateRepeats=function(a){var e,d=this;d._repeats=d._repeats||{},e=l(d._repeats,a),e.forEach(function(a){var h,i,j,k,e="["+c+'-repeat-wrapper="'+a.id+'"]',f=d.get(a.selector),g=[];a.filter=a.filter||[],b.dom(e).empty(),h=a.element.getAttribute("way-css"),void 0!=h&&void 0==a.element.getAttribute("way-wrapper-css")&&a.element.setAttribute("way-wrapper-css",a.element.className+" "),i=a.element.getAttribute("way-wrapper-css");for(j in f)b.dom(a.element).attr(c+"-scope",j),void 0!=i&&(a.element.className=i+f[j][a.element.getAttribute("way-css")]),k=b.dom(a.element).get(0).outerHTML,k=k.replace(/\$\$key/gi,j),g.push(k);b.dom(e).html(g.join("")),d.registerBindings(),d.updateBindings()})},e.prototype.updateForms=function(){var f,g,i,j,k,l,m,n,o,p,a=this,d="form["+c+"-data]",e=b.dom(d).get();for(f in e){g=e[f],i=a.dom(g).getOptions(),j=i.data,b.dom(g).removeAttr(c+"-data"),k=b.dom(g).find("[name]").reverse().get();for(f in k)l=k[f],m=b.dom(l).attr("name"),h(m,"[]")&&(n=m.split("[]")[0],o="[name^='"+n+"']",p=b.dom(g).find(o).get().length,m=n+"."+p),d=j+"."+m,i.data=d,a.dom(l).setOptions(i),b.dom(l).removeAttr("name")}},e.prototype.registerDependencies=function(){this.registerBindings(),this.registerRepeats()},e.prototype.updateDependencies=function(a){this.updateBindings(a),this.updateRepeats(a),this.updateForms(a)},e.prototype.setOptions=function(a,d){var f,g,h,e=this;d=e._element||d;for(f in a)g=c+"-"+f,h=a[f],b.dom(d).attr(g,h)},e.prototype.getOptions=function(a){var b=this,a=a||b._element,d={data:null,html:!1,readonly:!1,writeonly:!1,persistent:!1};return o.extend(d,b.dom(a).getAttrs(c))},e.prototype.getAttrs=function(a,c){var e,f,h,d=this;return c=c||d._element,e=function(a,b){var c={pick:"array",omit:"array",readonly:"boolean",writeonly:"boolean",json:"boolean",html:"boolean",persistent:"boolean"},d={array:function(a){return a.split(",")},"boolean":function(a){return"true"===a?!0:"false"===a?!1:!0}},e=function(){return b},f=c[a]||null,g=d[f]||e;return g(b)},f={},h=[].slice.call(b.dom(c).get(0).attributes),h.forEach(function(b){var d,h,c=a&&g(b.name,a+"-")?!0:!1;c&&(d=a?b.name.slice(a.length+1,b.name.length):b.name,h=e(d,b.value),o.contains(["transform","filter"],d)&&(h=h.split("|")),f[d]=h)}),f},e.prototype.scope=function(a,d){var f,g,h,i,j,k,l,m,n,e=this;d=d||e._element,f=c+"-scope",g=c+"-scope-break",h=[],i="",j="["+g+"], ["+f+"]",k=b.dom(d).parents(j).get();for(l in k){if(m=k[l],b.dom(m).attr(g))break;n=b.dom(m).attr(f),h.unshift(n)}return b.dom(d).attr(f)&&h.push(b.dom(d).attr(f)),b.dom(d).attr(g)&&(h=[]),i=o.compact(h).join(".")},e.prototype.get=function(a){var b=this;return void 0===a||o.isString(a)?b.data?a?D.get(b.data,a):b.data:{}:!1},e.prototype.set=function(a,b,c){if(!a)return!1;if("this"===a.split(".")[0])return console.log('Sorry, "this" is a reserved word in way.js'),!1;var d=this;if(c=c||{},a){if(!o.isString(a))return!1;d.data=d.data||{},d.data=a?D.set(d.data,a,b):{},d.updateDependencies(a),d.emitChange(a,b),c.persistent&&d.backup(a)}},e.prototype.push=function(a,b,c){if(!a)return!1;var d=this;c=c||{},a&&(d.data=a?D.push(d.data,a,b,!0):{}),d.updateDependencies(a),d.emitChange(a,null),c.persistent&&d.backup(a)},e.prototype.remove=function(a,b){var c=this;b=b||{},c.data=a?D.remove(c.data,a):{},c.updateDependencies(a),c.emitChange(a,null),b.persistent&&c.backup(a)},e.prototype.clear=function(){this.remove(null,{persistent:!0})},e.prototype.backup=function(){var b,a=this;if(a.options.persistent)try{b=a.data||{},localStorage.setItem(c,JSON.stringify(b))}catch(d){console.log("Your browser does not support localStorage.")}},e.prototype.restore=function(){var b,d,a=this;if(a.options.persistent)try{b=localStorage.getItem(c);try{b=JSON.parse(b);for(d in b)a.set(d,b[d])}catch(e){}}catch(e){console.log("Your browser does not support localStorage.")}},f=function(a,b){var e,c=["matches","matchesSelector","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],d=null;for(e in c)if(d=c[e],o.isFunction(a[d]))return a[d](b);return!1},g=function(a,b){return""===b?!0:null===a||null===b?!1:(a=String(a),b=String(b),a.length>=b.length&&a.slice(0,b.length)===b)},h=function(a,b){return""===b?!0:null===a||null===b?!1:(a=String(a),b=String(b),a.length>=b.length&&a.slice(a.length-b.length,a.length)===b)},i=function(a){return o.pick(a,o.compact(o.keys(a)))},j=function(a,b,c){var d=o.keys(a);return d.forEach(function(d){c?g(d,b)||delete a[d]:g(d,b)&&delete a[d]}),a},k=function(a,b,c){var e,f,d=D.flatten(a);for(e in b)d=j(d,b[e],c);return f=D.unflatten(d),i(f)},l=function(a,b){var d,e,f,h,c=[];if(b){d=b.split("."),e=d[d.length-1],f=!isNaN(e),f&&(d.pop(),h=d.join("."),c=a[h]?o.union(c,a[h]):c);for(h in a)g(h,b)&&(c=o.union(c,a[h]))}else for(h in a)c=o.union(c,a[h]);return c},n=function(a){return a&&o.isString(a)?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):a},o={},p=Array.prototype,q=Object.prototype,r=Function.prototype,Array.isArray,t=Object.keys,r.bind,v=p.push,w=p.slice,x=p.concat,y=q.toString,z=q.hasOwnProperty,A=function(a,b,c,d){var e,f,g;if(b&&o.every(a,o.isArray))return x.apply(d,a);for(e=0,f=a.length;f>e;e++)g=a[e],o.isArray(g)||o.isArguments(g)?b?v.apply(d,g):A(g,b,c,d):c||d.push(g);return d},B=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},o.compact=function(a){return o.filter(a,o.identity)},o.filter=function(a,b,c){var d=[];return null==a?d:(b=o.iteratee(b,c),o.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d)},o.identity=function(a){return a},o.every=function(a,b,c){if(null==a)return!0;b=o.iteratee(b,c);var f,g,d=a.length!==+a.length&&o.keys(a),e=(d||a).length;for(f=0;e>f;f++)if(g=d?d[f]:f,!b(a[g],g,a))return!1;return!0},o.union=function(){return o.uniq(A(arguments,!0,!0,[]))},o.uniq=function(a,b,c,d){var e,f,g,h,i,j;if(null==a)return[];for(o.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=o.iteratee(c,d)),e=[],f=[],g=0,h=a.length;h>g;g++)i=a[g],b?(g&&f===i||e.push(i),f=i):c?(j=c(i,g,a),o.indexOf(f,j)<0&&(f.push(j),e.push(i))):o.indexOf(e,i)<0&&e.push(i);return e},o.pick=function(a,b,c){var e,f,g,h,i,d={};if(null==a)return d;if(o.isFunction(b)){b=B(b,c);for(e in a)f=a[e],b(f,e,a)&&(d[e]=f)}else for(g=x.apply([],w.call(arguments,1)),a=new Object(a),h=0,i=g.length;i>h;h++)e=g[h],e in a&&(d[e]=a[e]);return d},o.has=function(a,b){return null!=a&&z.call(a,b)},o.keys=function(a){var b,c;if(!o.isObject(a))return[];if(t)return t(a);b=[];for(c in a)o.has(a,c)&&b.push(c);return b},o.contains=function(a,b){return null==a?!1:(a.length!==+a.length&&(a=o.values(a)),o.indexOf(a,b)>=0)},o.sortedIndex=function(a,b,c,d){var e,f,g,h;for(c=o.iteratee(c,d,1),e=c(b),f=0,g=a.length;g>f;)h=f+g>>>1,c(a[h])<e?f=h+1:g=h;return f},o.property=function(a){return function(b){return b[a]}},o.iteratee=function(a,b,c){return null==a?o.identity:o.isFunction(a)?B(a,b,c):o.isObject(a)?o.matches(a):o.property(a)},o.pairs=function(a){var e,b=o.keys(a),c=b.length,d=Array(c);for(e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},o.matches=function(a){var b=o.pairs(a),c=b.length;return function(a){var d,e,f;if(null==a)return!c;for(a=new Object(a),d=0;c>d;d++)if(e=b[d],f=e[0],e[1]!==a[f]||!(f in a))return!1;return!0}},o.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=o.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}for(;e>d;d++)if(a[d]===b)return d;return-1},o.values=function(a){var e,b=o.keys(a),c=b.length,d=Array(c);for(e=0;c>e;e++)d[e]=a[b[e]];return d},o.extend=function(a){var b,c,d,e;if(!o.isObject(a))return a;for(d=1,e=arguments.length;e>d;d++){b=arguments[d];for(c in b)z.call(b,c)&&(a[c]=b[c])}return a},o.isArray=function(a){return"[object Array]"===y.call(a)},o.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"===y.call(a)},o.isUndefined=function(a){return void 0===a},o.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},o.each=function(a,b,c){var d,e,f;if(null==a)return a;if(b=B(b,c),e=a.length,e===+e)for(d=0;e>d;d++)b(a[d],d,a);else for(f=o.keys(a),d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a);return a},o.each(["Arguments","Function","String","Number","Date","RegExp"],function(a){o["is"+a]=function(b){return y.call(b)==="[object "+a+"]"}}),C=function(a,b,c,d){var f,e=b.replace(/\[(["']?)([^\1]+?)\1?\]/g,".$2").replace(/^\./,"").split("."),g=0,h=e.length;if(arguments.length>2){for(f=a,h--;h>g;)b=e[g++],a=a[b]=o.isObject(a[b])?a[b]:{};d?o.isArray(a)?a.splice(e[g],1):delete a[e[g]]:a[e[g]]=c,c=f}else{for(;null!=(a=a[e[g++]])&&h>g;);c=h>g?void 0:a}return c},D={},D.VERSION="0.1.0",D.debug=!0,D.exit=function(a,b,c,d){var e,f;D.debug&&(e={},e.noJSON="Not a JSON",e.noString="Not a String",e.noArray="Not an Array",e.missing="Missing argument",f={source:a,data:c,value:d},f.message=e[b]?e[b]:"No particular reason",console.log("Error",f))},D.is=function(a){return"[object Object]"==y.call(a)},D.isStringified=function(a){var b=!1;try{b=/^[\],:{}\s]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))}catch(c){}return b},D.get=function(a,b){return void 0==a?D.exit("get","missing","json",a):void 0==b?D.exit("get","missing","selector",b):o.isString(b)?C(a,b):D.exit("get","noString","selector",b)},D.set=function(a,b,c){return void 0==a?D.exit("set","missing","json",a):void 0==b?D.exit("set","missing","selector",b):o.isString(b)?c?C(a,b,c):D.remove(a,b):D.exit("set","noString","selector",b)},D.remove=function(a,b){return void 0==a?D.exit("remove","missing","json",a):void 0==b?D.exit("remove","missing","selector",b):o.isString(b)?C(a,b,null,!0):D.exit("remove","noString","selector",b)},D.push=function(a,b,c,d){if(void 0==a)return D.exit("push","missing","json",a);if(void 0==b)return D.exit("push","missing","selector",b);var e=D.get(a,b);if(!o.isArray(e)){if(!d)return D.exit("push","noArray","array",e);e=[]}return e.push(c),D.set(a,b,e)},D.unshift=function(a,b,c){if(void 0==a)return D.exit("unshift","missing","json",a);if(void 0==b)return D.exit("unshift","missing","selector",b);if(void 0==c)return D.exit("unshift","missing","value",c);var d=D.get(a,b);return o.isArray(d)?(d.unshift(c),D.set(a,b,d)):D.exit("unshift","noArray","array",d)},D.flatten=function(a){function c(a,d){var e,f,g,h;if(Object(a)!==a)b[d]=a;else if(Array.isArray(a))for(e=0,f=a.length;f>e;e++)c(a[e],d?d+"."+e:""+e),0==f&&(b[d]=[]);else{g=!0;for(h in a)g=!1,c(a[h],d?d+"."+h:h);g&&(b[d]={})}}if("Object"!=a.constructor.name)return D.exit("flatten","noJSON","json",a);var b={};return c(a,""),b},D.unflatten=function(a){var c,d,e,f,g,b,h;if(Object(a)!==a||Array.isArray(a))return a;b={};for(h in a){c=b,d="",f=0;do e=h.indexOf(".",f),g=h.substring(f,-1!==e?e:void 0),c=c[d]||(c[d]=isNaN(parseInt(g))?{}:[]),d=g,f=e+1;while(e>=0);c[d]=a[h]}return b[""]},D.prettyprint=function(a){return JSON.stringify(a,void 0,2)},E=function(){},E.constructor=E,E.prototype.dom=function(a,b){var e,f,c=this,d=[];if(!b)return o.isString(a)?d=[].slice.call(document.querySelectorAll(a)):o.isObject(a)&&a.attributes&&(d=[a]),c._elements=d,c.length=d.length,c;e=document.createElement(a);for(f in b)e[f]=b[f]},E.prototype.on=function(a,b){var e,f,g,h,i,c=this,d=c._elements;for(a=a.split(" "),e=0,f=d.length;f>e;e++)for(g=d[e],h=0,i=a.length;i>h;h++)g.addEventListener&&g.addEventListener(a[h],b,!1)},E.prototype.find=function(a){var b=this,c=b.get(0),d=[];return o.isString(a)&&(d=[].slice.call(c.querySelectorAll(a))),b._elements=d,b},E.prototype.get=function(a,b){var c=this,d=c._elements||[],e=d[a]||{};return b?(c._element=e,c):o.isNumber(a)?e:d},E.prototype.reverse=function(){return this._elements=this._elements.reverse(),this},E.prototype.val=function(a){return this.prop("value",a)},E.prototype.type=function(a){return this.prop("type",a)},E.prototype.html=function(a){return this.prop("innerHTML",a)},E.prototype.text=function(a){return this.prop("innerHTML",n(a))},E.prototype.prop=function(a,b){var e,c=this,d=c._elements;for(e in d){if(o.isUndefined(b))return d[e][a];d[e][a]=b}},E.prototype.attr=function(a,b){var e,c=this,d=c._elements;for(e in d){if(void 0===b)return d[e].getAttribute(a);d[e].setAttribute(a,b)}return c},E.prototype.removeAttr=function(a){var c,b=this;for(c in b._elements)b._elements[c].removeAttribute(a);return b},E.prototype.addClass=function(a){var c,b=this;for(c in b._elements)b._elements[c].classList.add(a);return b},E.prototype.removeClass=function(a){var c,b=this;for(c in b._elements)b._elements[c].classList.remove(a);return b},E.prototype.parents=function(a){for(var g,h,i,b=this,c=b.get(0),d=c.parentNode,e=[];null!==d;)g=d,h=f(g,a),i=void 0===g.doctype?!0:!1,a||(h=!0),h&&i&&e.push(g),d=g.parentNode;return b._elements=e,b},E.prototype.parent=function(a){var b=this,c=b.get(0),d=c.parentNode,e=f(d,a);return a||(e=!0),e?d:{}},E.prototype.clone=function(a){var b=this,c=b.get(0),d=c.cloneNode(!0);return b._elements=[d],a?b:d},E.prototype.empty=function(a){var b=this,c=b.get(0);if(!c||!c.hasChildNodes)return a?b:c;for(;c.hasChildNodes();)c.removeChild(c.lastChild);return a?b:c},E.prototype.replaceWith=function(a){var b=this,c=b.get(0),d=c.parentNode;d.replaceChild(a,c)},E.prototype.ready=function(a){document&&o.isFunction(document.addEventListener)?document.addEventListener("DOMContentLoaded",a,!1):window&&o.isFunction(window.addEventListener)?window.addEventListener("load",a,!1):document.onreadystatechange=function(){"complete"===document.readyState&&a()}},a=new e,F=null,G=function(c){F&&clearTimeout(F),F=setTimeout(function(){var d=b.dom(c.target).get(0);a.dom(d).toStorage()},a.options.timeout)},H=function(b){b.preventDefault();var c=a.dom(this).getOptions();a.remove(c.data,c)},I=function(b){var c,d,e,f;return b.preventDefault(),c=a.dom(this).getOptions(),c&&c["action-push"]?(d=c["action-push"].split(":"),e=d[0]||null,f=d[1]||null,a.push(e,f,c),void 0):!1},J=function(b){b.preventDefault();var c=a.dom(this).getOptions();return c&&c["action-remove"]?(a.remove(c["action-remove"],c),void 0):!1},K=null,L=function(){K&&clearTimeout(K),K=setTimeout(function(){a.registerDependencies(),M()},a.options.timeoutDOM)},b=new E,a.w=b,M=function(){b.dom("body").on("DOMSubtreeModified",L),b.dom("["+c+"-data]").on("input change",G),b.dom("["+c+"-clear]").on("click",H),b.dom("["+c+"-action-remove]").on("click",J),b.dom("["+c+"-action-push]").on("click",I)},N=function(){M(),a.restore(),a.setDefaults(),a.registerDependencies(),a.updateDependencies()},b.ready(N),a});