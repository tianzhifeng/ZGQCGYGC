@{
    ViewBag.Title = "Viewer";
    Layout = null;
}
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head runat="server">
    <title>浏览</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta http-equiv="pragma" content="no-cache" />
    <style type="text/css" media="screen">
        html, body {
            height: 100%;
        }

        body {
            margin: 0;
            padding: 0;
            overflow: auto;
        }

        #flashContent {
            display: none;
        }
    </style>
    <script src="@Url.Content("~/Scripts/FlexPaper/jquery.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/FlexPaper/flexpaper_flash.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/FlexPaper/flexpaper_flash_debug.js")" type="text/javascript"></script>
</head>
<body style="overflow:hidden">
    <div style="position: absolute; width:100%;text-align:center">
        @{
            if (!ViewBag.IsExist)
            {
                <div style="line-height:300px; display: block; border: 0px;">
                    浏览文件正在处理，请稍后再试！
                </div>
            }
            else
            {
                <a id="viewerPlaceHolder" style="width: 100%; height: 100%; display: block"></a>
                <script type="text/javascript">
                    //$("#viewerPlaceHolder").width($(window).width());
                    $("#viewerPlaceHolder").height($(window).height());

                    var fp = new FlexPaperViewer(
                    '@Url.Content("~/Scripts/FlexPaper/FlexPaperViewer")',
                    'viewerPlaceHolder', {
                        config: {
                            SwfFile: '@Html.Raw(ViewBag.FilePath)',
                            Scale: 1,
                            ZoomTransition: 'easeOut',
                            ZoomTime: 0.5,
                            ZoomInterval: 0.2,
                            FitPageOnLoad: false,
                            FitWidthOnLoad: true,
                            PrintEnabled: 'False',
                            PrintToolsVisible: 'False',
                            FullScreenAsMaxWindow: false,
                            ProgressiveLoading: false,
                            MinZoomSize: 0.2,
                            MaxZoomSize: 5,
                            SearchMatchAll: false,
                            InitViewMode: 'Portrait',
                            ViewModeToolsVisible: true,
                            ZoomToolsVisible: true,
                            NavToolsVisible: true,
                            CursorToolsVisible: false,
                            SearchToolsVisible: false,
                            localeChain: 'zh_CN'
                        }
                    });
                </script>
            }
        }
    </div>
</body>
</html>
