@{
    ViewBag.Title = "MainContentProject";
}
<script src="/Project/Scripts/EngineeringSpace/js/jquery.min.js" type="text/javascript"></script>
<!--MiniUI-->
<link href="/Project/Scripts/EngineeringSpace/css/bootstrap.min.css" rel="stylesheet"
      type="text/css" />
<link href="/Project/Scripts/EngineeringSpace/css/font-awesome.min.css" rel="stylesheet"
      type="text/css" />
<script src="/Project/Scripts/EngineeringSpace/js/bootstrap.min.js" type="text/javascript"></script>
<script src="/Project/Scripts/EngineeringSpace/js/jquery.nicescroll.js" type="text/javascript"></script>
<link rel="stylesheet" href="/Project/Scripts/EngineeringSpace/css/content-pro.css" />
<script src="/CommonWebResource/CoreLib/HighCharts/highcharts.js" type="text/javascript"></script>
<script src="/CommonWebResource/CoreLib/HighCharts/highcharts-3d.js" type="text/javascript"></script>
<script>
    $("body").css("background-color","");
</script>
@{
    var projectInfo = ViewBag.ProjectInfo as Project.Logic.Domain.S_I_ProjectInfo;

    var difDay = 0;
    if (projectInfo.CreateDate != null)
    {
        var timeSpan = DateTime.Now.Subtract(projectInfo.CreateDate);
        difDay = timeSpan.Days + 1;
    }
    <div id="tab-content-container">
        <div class="tab-content-right">
            <div class="tab-content">
                <div role="tabpanel" class="tab-pane active">
                    <div class="tab-content-title clearfix">
                        <div class="left-img pull-left">
                        </div>
                        <div class="pull-left tab-title-left">
                            <h4>
                                @projectInfo.Name<span> · @projectInfo.Code</span>
                            </h4>
                            <div style="postion: absolute; padding-top: 3px">
                                @if (!string.IsNullOrEmpty(projectInfo.CustomerName))
                                {
                                    <div class="edlink" id="customerInfo">
                                        <a href="javascript:void(0)" onclick="openUrl('/Market/Basic/Customer/Index?FuncType=view&ID=@projectInfo.CustomerID','客户信息查看')">@projectInfo.CustomerName</a>
                                    </div>
                                }
                                @if (!string.IsNullOrEmpty(projectInfo.PhaseName))
                                {
                                    <div class="edtag">
                                        <span class="state-panel">&nbsp;@projectInfo.PhaseName </span>
                                    </div>
                                }
                                @if (!string.IsNullOrEmpty(projectInfo.ProjectClass))
                                {
                                    <div class="edtag">
                                        <span class="state-panel">&nbsp;@projectInfo.ProjectClass</span>
                                    </div>
                                }
                            </div>
                        </div>
                        <div class="pull-right tab-title-right">
                            <p>
                                <span class="has-mar">出图总量：<span>400个</span></span>
                                <span class="has-mar">提交总量：<span>600个</span></span>
                                @{
                                    var proportion = 0m;
                                    if (projectInfo.Proportion.HasValue)
                                    {
                                        proportion = Math.Round(projectInfo.Proportion.Value, 2);
                                    }
                                    <span class="has-mar">进度表下达天数：<span>@difDay 天</span></span><span class="has-mar">
                                        占地面积：
                                        @proportion ㎡
                                    </span> <span class="has-mar">
                                        建筑面积：
                                        @proportion ㎡
                                    </span>
                                }
                            </p>
                            <p>
                                <span class="has-mar">参与部门：<span>XXXXX部门,XXXX部门</span></span>
                            </p>
                        </div>
                    </div>
                    <div class="tab-content-bottom clearfix">
                        <div class="tab-content--bottom-slider">
                            <ul class="slider-wrap">
                                @{
                                    var QBSCatagoryList = ViewBag.QBSCatagoryList as List<Project.Logic.Domain.S_T_QBSTemplate>;
                                    var QBSList = ViewBag.QBSList as List<Project.Areas.Engineering.Controllers.EngineeringSpaceController.QBSTemplateInfo>;
                                    var qualitative = Project.Logic.QBSType.Qualitative.ToString();

                                    foreach (var catagory in QBSCatagoryList)
                                    {
                                        <li>
                                            <div class="title">
                                                <img src="/Project/Scripts/EngineeringSpace/images/pro-item.png" alt="" />
                                                <span>@catagory.Name</span>
                                            </div>
                                            <ul class="wrap-ul">
                                                @foreach (var qbs in QBSList)
                                                {
                                                    if (qbs.ParentID != catagory.ID)
                                                    {
                                                        continue;
                                                    }
                                                    if (qbs.QBSType == qualitative)
                                                    {
                                                        if (!string.IsNullOrEmpty(qbs.ResState))
                                                        {
                                                            <li class="clearfix finish" onclick="openUrl('@qbs.LinkUrl','@qbs.Name')">
                                                                <div class="pull-left">
                                                                    <img src="/Project/Scripts/EngineeringSpace/images/pro-item-green.png" alt="" />
                                                                    <span>@qbs.Name</span>
                                                                    <img src="/Project/Scripts/EngineeringSpace/images/fet.png" alt="" />
                                                                </div>
                                                                <div class="pull-right">
                                                                    <img src="/Project/Scripts/EngineeringSpace/images/pro-ok-green.png" alt="" />
                                                                    <p>
                                                                        @qbs.ResState
                                                                    </p>
                                                                </div>
                                                            </li>
                                                        }
                                                        else
                                                        {
                                                            <li class="clearfix unfinish" style="cursor: default;">
                                                                <div class="pull-left">
                                                                    <img src="/Project/Scripts/EngineeringSpace/images/icon01.png" alt="" />
                                                                    <span>@qbs.Name</span> @*<img src="/Project/Scripts/EngineeringSpace/images/fet.png" alt="" />*@
                                                                </div>
                                                                <div class="pull-right">
                                                                    <img src="/Project/Scripts/EngineeringSpace/images/pro-ok-h.png" alt="" />
                                                                    <p>
                                                                        未完成
                                                                    </p>
                                                                </div>
                                                            </li>
                                                        }
                                                    }
                                                    else
                                                    {
                                                        <li class="clearfix number" onclick="openUrl('@qbs.LinkUrl','@qbs.Name')">
                                                            @{
                                                                var num = "0";
                                                                if (!string.IsNullOrEmpty(qbs.ResState))
                                                                {
                                                                    num = qbs.ResState;
                                                                }
                                                                <div class="pull-left">
                                                                    @{
                                                                        if (num == "0")
                                                                        {
                                                                            <img src="/Project/Scripts/EngineeringSpace/images/icon01.png" alt="" />}
                                                                        else
                                                                        {
                                                                            <img src="/Project/Scripts/EngineeringSpace/images/pro-item-green.png" alt="" />
                                                                        }
                                                                    }
                                                                    <span>@qbs.Name</span>
                                                                    <img src="/Project/Scripts/EngineeringSpace/images/fet.png" alt="" />
                                                                </div>
                                                                <div class="pull-right">
                                                                    <p>
                                                                        @num<span>@qbs.DataUnit</span>
                                                                    </p>
                                                                    <p>
                                                                    </p>
                                                                </div>
                                                            }
                                                        </li>
                                                                            }
                                                                        }
                                            </ul>
                                        </li>
                                                                        }
                                }
                            </ul>
                        </div>
                        <div class="tab-content--bottom-content">
                            <div class="tab-content--bottom-content-top">
                                <ul>
                                    @{
                                        var wbsInfo = ViewBag.WBSInfo as List<Project.Logic.Domain.S_W_WBS>;
                                        var projectType = Project.Logic.WBSNodeType.Project.ToString();
                                        var majorType = Project.Logic.WBSNodeType.Major.ToString();
                                        var majorWBSList = wbsInfo.Where(d => d.WBSType == projectType || d.WBSType == majorType).Select(d => new
                                        {
                                            Name = d.Name,
                                            WBSType = d.WBSType,
                                            WBSValue = d.WBSValue
                                        }).Distinct().ToList();
                                        var obsUserInfo = ViewBag.ObsUserInfo as List<Project.Areas.Engineering.Controllers.EngineeringSpaceController.OBSUserInfo>;
                                        var productList = ViewBag.ProductList as List<Project.Logic.Domain.S_E_Product>;
                                        var workHourList = ViewBag.WorkHourList as List<Project.Areas.Engineering.Controllers.WorkHourViewList>;

                                        foreach (var wbs in majorWBSList)
                                        {
                                            var wsbName = "";
                                            int peopleNum = 0;
                                            var overviewName = "";
                                            var curOBSUsers = new List<Project.Areas.Engineering.Controllers.EngineeringSpaceController.OBSUserInfo>();
                                            var curProductList = new List<Project.Logic.Domain.S_E_Product>();
                                            var curWorkHourList = new List<Project.Areas.Engineering.Controllers.WorkHourViewList>();
                                            var productNum = 0;
                                            DateTime? lastestSubmitDate = null;
                                            string printText = "";
                                            string productNumText = "";
                                            string workHourText = "";
                                            string wbsValueStr = "";//查看工时明细
                                            if (wbs.WBSType == projectType)
                                            {
                                                continue;
                                                printText = "出图总量";
                                                productNumText = "提交总量";
                                                wsbName = "项目";
                                                workHourText = "总工时";
                                                curOBSUsers = obsUserInfo.Where(d => string.IsNullOrEmpty(d.MajorValue)).ToList();
                                                curProductList = productList.OrderByDescending(d => d.CreateDate).ToList();
                                                curWorkHourList = workHourList;
                                            }
                                            else
                                            {
                                                printText = "出图量";
                                                productNumText = "提交量";
                                                wsbName = wbs.Name;
                                                workHourText = "";
                                                curOBSUsers = obsUserInfo.Where(d => d.MajorValue == wbs.WBSValue).OrderBy(d => d.SortIndex).ToList();
                                                curProductList = productList.Where(d => d.MajorValue == wbs.WBSValue).OrderByDescending(d => d.CreateDate).ToList();
                                                curWorkHourList = workHourList.Where(a => a.MajorCode == wbs.WBSValue).ToList();
                                                wbsValueStr = "&MajorValue=" + wbs.WBSValue;
                                            }
                                            peopleNum = curOBSUsers.Count;
                                            if (peopleNum != 0)
                                            {
                                                int i = 0;
                                                foreach (var obsUserName in curOBSUsers.Select(d => d.UserName).Distinct())
                                                {
                                                    if (i > 1)
                                                    {
                                                        break;
                                                    }
                                                    overviewName += obsUserName + ",";
                                                    i++;
                                                }
                                                overviewName = overviewName.TrimEnd(',');
                                            }

                                            productNum = curProductList.Count;
                                            if (productNum != 0)
                                            {
                                                lastestSubmitDate = curProductList.FirstOrDefault().CreateDate;
                                            }
                                            var printNum = curProductList.Select(d => d.PrintCount).Sum();
                                            var workHourNumSum = curWorkHourList.Select(d => d.WorkHourValue).Sum();
                                            int workHourNum = 0;
                                            if (workHourNumSum.HasValue)
                                            {
                                                workHourNum = Convert.ToInt16(workHourNumSum.Value);
                                            }

                                            <li>
                                                <div>
                                                    <div class="classify">
                                                        <div>
                                                            <div>
                                                                <span class="title">@wsbName</span>
                                                            </div>
                                                            <div>
                                                                <img src="/Project/Scripts/EngineeringSpace/images/people-w.png" alt="" />
                                                                @{
                                                                    if (peopleNum == 0)
                                                                    {
                                                                        <span>暂无人员</span>
                                                                    }
                                                                    else
                                                                    {
                                                                        <span>@overviewName 共 @peopleNum 人</span> <span class="icon icon-double-angle-down"
                                                                                                                        style="cursor: pointer"></span>
                                                                    }
                                                                }
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="block">
                                                        <div style="cursor: pointer">
                                                            @{
                                                                string submitText = "暂无成果";
                                                                string submitTitle = "";
                                                                if (lastestSubmitDate.HasValue)
                                                                {
                                                                    submitTitle = lastestSubmitDate.Value.ToString("yyyy-MM-dd");
                                                                    TimeSpan span = DateTime.Now - lastestSubmitDate.Value.Date;
                                                                    if (span.Days > 365)
                                                                    { submitText = string.Format("{0}年前", span.Days / 365); }
                                                                    else if (span.Days > 30)
                                                                    { submitText = string.Format("{0}个月前", span.Days / 30); }
                                                                    else if (span.Days > 7)
                                                                    { submitText = string.Format("{0}周前", span.Days / 7); }
                                                                    else if (span.Days >= 1)
                                                                    { submitText = string.Format("{0}天前", span.Days); }
                                                                    else
                                                                    { submitText = "今天"; }
                                                                }
                                                                <span>
                                                                    <img src="/Project/Scripts/EngineeringSpace/images/space-productrecent.png" alt="" />
                                                                    最新上传：
                                                                </span><span title="@submitTitle">@submitText</span>
                                                            }
                                                        </div>
                                                        <div>
                                                            <span>
                                                                <img src="/Project/Scripts/EngineeringSpace/images/space-productprint.png" alt="" />
                                                                @printText：
                                                            </span><span><a href="javascript:openUrl('/MvcConfig/UI/List/PageView?TmplCode=ProductDetail&ProjectInfoID=@projectInfo.ID@wbsValueStr&PrintState=Printed','@wsbName@printText')">@printNum</a> 张</span>
                                                        </div>
                                                        <div>
                                                            <span>
                                                                <img src="/Project/Scripts/EngineeringSpace/images/space-product.png" alt="" />
                                                                @productNumText：
                                                            </span><span><a href="javascript:openUrl('/MvcConfig/UI/List/PageView?TmplCode=ProductDetail&ProjectInfoID=@projectInfo.ID@wbsValueStr','@wsbName@productNumText')">@productNum</a> 张</span>
                                                        </div>
                                                    </div>
                                                    <div class="block">
                                                        <div style="display: inline-block; line-height: 30px; width: 100%">
                                                            <span style="width: 100%; text-align: center">@workHourText</span>
                                                            <div>
                                                                @if (wbs.WBSType == projectType)
                                                                {
                                                                    @*<span style="width: 100%; text-align: center"><a href="javascript:openUrl('/MvcConfig/UI/List/PageView?TmplCode=WorkHourMajorDetail&ProjectID=@projectInfo.ID','@wsbName@workHourText','500px')">@workHourNum</a></span>*@
                                                                }
                                                                else
                                                                {
                                                                    @*<span style="width: 100%; text-align: center"><a href="javascript:openUrl('/MvcConfig/UI/List/PageView?TmplCode=WorkHourDetail&ProjectID=@projectInfo.ID@wbsValueStr.Replace("MajorValue", "MajorCode")','@wsbName@workHourText','70%')">@workHourNum</a></span>*@
                                                                }
                                                            </div>
                                                        </div>
                                                    </div>
                                                    @if (wbs.WBSType == projectType)
                                                    {
                                                        <div class="block">
                                                            <div style="font-weight: bolder;">
                                                                <span>
                                                                    <img src="/Project/Scripts/EngineeringSpace/images/space-projectcost.png" alt="" />
                                                                    项目支出：
                                                                </span><span><a href="javascript:LinkToCost('','')">@ViewBag.TotalCostValue</a> 万元</span>
                                                            </div>
                                                            <div>
                                                                <span>
                                                                    <img src="/Project/Scripts/EngineeringSpace/images/space-cost.png" alt="" />
                                                                    报销支出：
                                                                </span><span><a href="javascript:LinkToCost('Production','')">@ViewBag.DirectValue</a> 万元</span>
                                                            </div>
                                                            <div>
                                                                <span>
                                                                    <img src="/Project/Scripts/EngineeringSpace/images/space-costpayment.png" alt="" />
                                                                    分包支出：
                                                                </span><span><a href="javascript:LinkToCost('','Payment')">@ViewBag.PaymentCostValue</a> 万元</span>
                                                            </div>
                                                        </div>
                                                    }
                                                    @*<div class="outimg">
                                                            <div style="display: inline-block; line-height: 30px">
                                                                <span>@printText</span>
                                                                <div>
                                                                    <span>@printNum</span>张
                                                                </div>
                                                            </div>
                                                            <div class="printCount" style="width: 60%; height:60px;float:right" id="printCount_@wbs.WBSValue">
                                                            </div>
                                                        </div>
                                                        <div class="commitimg">
                                                            <div style="display: inline-block; line-height: 30px">
                                                                <span>@productNumText</span>
                                                                <div>
                                                                    <span>@productNum</span>张
                                                                </div>
                                                            </div>
                                                            <div class="productNum" style="width: 60%; height:60px; float:right" id="productNum_@wbs.WBSValue">
                                                            </div>
                                                        </div>*@
                                                </div>
                                                @{
                                                    if (peopleNum != 0)
                                                    {
                                                        <div class="people">
                                                            <ul class="clearfix green">
                                                                @{
                                                                    foreach (var obsUser in curOBSUsers)
                                                                    {
                                                                        <li class="clearfix" style="cursor: pointer;" onclick="openUrl('/Project/ProjectGroup/PersonnelLoad/MainTab?ProjectInfoID=@projectInfo.ID&MarketProjectInfoID=@projectInfo.MarketProjectInfoID&UserID=@obsUser.UserID','@obsUser.UserName')">
                                                                            <div>
                                                                                <img src="/Project/Scripts/EngineeringSpace/images/people.png" alt="" />
                                                                                <span>@obsUser.UserName</span>
                                                                            </div>
                                                                            <div>
                                                                                <p>
                                                                                    @obsUser.RoleName
                                                                                </p>
                                                                                <span>@obsUser.TEL</span>
                                                                            </div>
                                                                        </li>
                                                                    }
                                                                }
                                                            </ul>
                                                        </div>
                                                                    }
                                                }
                                            </li>
                                                                    }
                                    }
                                </ul>
                            </div>
                            <div class="tab-content--bottom-content-bottom">
                                <ul class="clearfix">
                                    @{
                                        var subProjectWBSList = ViewBag.MileStoneWBSList as List<Project.Logic.Domain.S_W_WBS>;
                                        var liActiveFlag = true;
                                        if (subProjectWBSList.Count == 0)
                                        {
                                            <div style="height: 400px; text-align: center; line-height: 100px; color: #cdced2; font-size: 14px;">
                                                尚未策划内容
                                            </div>
                                        }
                                        else
                                        {
                                            if (subProjectWBSList.Count == 1 && subProjectWBSList.FirstOrDefault().WBSType == "Project")
                                            {
                                                <li class="active" style="cursor: pointer">@subProjectWBSList[0].Name</li>
                                            }
                                            else
                                            {
                                                @*foreach (var wbs in subProjectWBSList)
                                                            {
                                                                if (liActiveFlag)
                                                                {
                                                    <li class="active" style="cursor: pointer">@wbs.Name</li>
                                                                    liActiveFlag = false;
                                                                }
                                                                else
                                                                {
                                                    <li style="cursor: pointer">@wbs.Name</li>
                                                                }
                                                            }*@
                                            }
                                        }
                                    }
                                </ul>
                                <div class="table-container">
                                    @{
                                        var mileStonList = ViewBag.MileStoneList as List<Project.Logic.Domain.S_P_MileStone>;
                                        var activeState = "";
                                        for (int i = 0; i < subProjectWBSList.Count; i++)
                                        {
                                            var wbs = subProjectWBSList[i];
                                            if (i == 0)
                                            {
                                                activeState = "active";
                                            }
                                            else
                                            {
                                                activeState = "";
                                            }

                                            <table class="table @activeState">
                                                <thead>
                                                    <tr>
                                                        <th style="width: 40%">
                                                            工作内容

                                                        </th>
                                                        <th style="width: 10%">
                                                            资料类别

                                                        </th>
                                                        <th style="text-align: center;width: 15%">
                                                            承担工种
                                                        </th>
                                                        <th style="text-align: center;width: 15%">
                                                            接收工种
                                                        </th>
                                                        <th style="text-align: center;width: 10%">
                                                            进度表日期
                                                        </th>
                                                        <th style="text-align: center;width: 10%">
                                                            实际完成时间
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @{
                                                        var cooperation = Project.Logic.MileStoneType.Cooperation.ToString();
                                                        var subMileStoneList = mileStonList.Where(d => d.WBSID == wbs.ID && d.MileStoneType != cooperation).OrderBy(d => d.SortIndex).ToList();
                                                        if (subMileStoneList.Count == 0)
                                                        {
                                                            <tr>
                                                                <td colspan="4">
                                                                    <div style="height: 80px; text-align: center; line-height: 100px; color: #cdced2; font-size: 14px;">
                                                                        尚未策划里程碑内容
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            continue;
                                                        }

                                                        var majorDic = ViewBag.MajorDic as Dictionary<string, string>;
                                                        foreach (var milestone in subMileStoneList)
                                                        {
                                                            var majorName = "";
                                                            if (!string.IsNullOrEmpty(milestone.MajorValue))
                                                            {
                                                                if (majorDic.Keys.Contains(milestone.MajorValue))
                                                                {
                                                                    majorName = majorDic[milestone.MajorValue];
                                                                }
                                                                else { continue; }
                                                            }

                                                            var finish = Project.Logic.ProjectCommoneState.Finish.ToString();
                                                            var dateNow = DateTime.Now.Date;
                                                            var stateSrc = "";
                                                            var milestoneTitle = "";
                                                            if (milestone.State == finish && milestone.PlanFinishDate.HasValue
                                                                && milestone.FactFinishDate.HasValue
                                                                && milestone.FactFinishDate.Value.Date > milestone.PlanFinishDate.Value)
                                                            {
                                                                stateSrc = "/Project/Scripts/Flag/images/DelayFinish.png";
                                                                milestoneTitle = "延期完成";
                                                            }
                                                            else if (milestone.State == finish && (!milestone.PlanFinishDate.HasValue
                                                               || !milestone.FactFinishDate.HasValue
                                                               || milestone.FactFinishDate.Value.Date <= milestone.PlanFinishDate.Value))
                                                            {
                                                                stateSrc = "/Project/Scripts/Flag/images/NormalFinish.png";
                                                                milestoneTitle = "正常完成";
                                                            }
                                                            else if (milestone.State != finish &&
                                                               milestone.PlanFinishDate.HasValue &&
                                                               dateNow > milestone.PlanFinishDate.Value)
                                                            {
                                                                stateSrc = "/Project/Scripts/Flag/images/DelayUndone.png";
                                                                milestoneTitle = "延期未完成";
                                                            }
                                                            else if (milestone.State != finish &&
                                                               milestone.PlanFinishDate.HasValue &&
                                                               (dateNow <= milestone.PlanFinishDate.Value)
                                                                || !milestone.PlanFinishDate.HasValue)
                                                            {
                                                                stateSrc = "/Project/Scripts/Flag/images/NormalUndone.png";
                                                                milestoneTitle = " 正常进行中";
                                                            }

                                                            <tr>
                                                                <td>
                                                                    <img title="@milestoneTitle" src="@stateSrc" alt="" />
                                                                    <span>@milestone.Name</span>
                                                                </td>
                                                                <td style="text-align: center;">
                                                                    @majorName
                                                                </td>
                                                                @{
                                                                    if (milestone.PlanFinishDate.HasValue)
                                                                    {
                                                                        <td style="text-align: center;">
                                                                            @milestone.PlanFinishDate.Value.ToString("yyyy-MM-dd")
                                                                        </td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td style="text-align: center;"></td>
                                                                    }
                                                                    if (milestone.FactFinishDate.HasValue)
                                                                    {
                                                                        <td style="text-align: center;">
                                                                            @milestone.FactFinishDate.Value.ToString("yyyy-MM-dd")
                                                                        </td>
                                                                    }
                                                                    else
                                                                    {
                                                                        <td style="text-align: center;"></td>
                                                                    }
                                                                }
                                                            </tr>
                                                                    }
                                                    }
                                                </tbody>
                                            </table>
                                                                    }
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
<script type="text/javascript">
    var ProductNumJson=@Html.Raw(ViewBag.ProductNumColumnOption);
    var PrintCountJson=@Html.Raw(ViewBag.PrintCountColumnOption);
    var ProjectInfoID='@projectInfo.ID';
    var MarketProjectInfoID='@projectInfo.MarketProjectInfoID';
</script>
<script type="text/javascript">

    $(document).ready(function () {
        $("#tab-content-container").niceScroll({ cursorborder: "none" });
        $(".tab-content-contents-right").niceScroll({ cursorborder: "none" });
        $(".tab-content--bottom-content-top").niceScroll({ cursorwidth:"10px",cursorborder: "none",oneaxismousemode: false,cursordragontouch:true });

        //var colors = ['#7cb5ec'];
        //var idx = 0;
        //$.each(ProductNumJson,
        //    function (i, v) {
        //        var opt = $.extend(true, { colors: colors }, mini.decode(v));
        //        $("#" + i).highcharts(opt);
        //    });
        //idx = 0;
        //$.each(PrintCountJson,
        //    function (i, v) {
        //        var opt = $.extend(true, { colors: colors }, mini.decode(v));
        //        $("#" + i).highcharts(opt);
        //    });
    });


    var color = ["#00b3bd", "#df62c8", "#c8353b", "#1e83df"]
    for (var i = 0; i < $(".tab-content-item").length; i++) {
        $(".tab-content-item").eq(i).find("h3").css("color", color[i]);
        if (i % 2 == 0) {
            $(".tab-content-item").eq(i).css("margin-right", "8px");
        } else {

            $(".tab-content-item").eq(i).css("margin-left", "8px");
        }
    }

    $(".tab-content-item .item-bottom ul li>div").on("mouseover", function () {
        var index = $(this).closest(".tab-content-item").index();
        $(this).find("div").css({ "background-color": color[index], "color": "#fff" });
        $(this).stop();
        $(this).animate({
            width: "200px"
        }, 300);
    }).on("mouseout", function () {
        var index = $(this).closest(".tab-content-item").index();
        $(this).find("div").css({ "background-color": "#fff", "color": "black" });
        $(this).stop();
        $(this).animate({
            width: "54px"
        }, 300);
    })

    $(".tab-content--bottom-content-top > ul > li .people").css("max-height","none").hide();
    $("body").on("click", " .icon-double-angle-down", function () {
        $(this).closest("li").find(".people").show(500,function() {
            $(".tab-content--bottom-content-top").getNiceScroll().resize();
        });
        $(this).attr("class", "icon-double-angle-up");
    });
    $("body").on("click", " .icon-double-angle-up", function () {
        $(this).closest("li").find(".people").hide(500,function() {
            $(".tab-content--bottom-content-top").getNiceScroll().resize();
        });
        $(this).attr("class", "icon-double-angle-down");
    });
    /////table选择
    $(".tab-content--bottom-content-bottom ul li").on("click", function () {
        $(this).addClass("active").siblings().removeClass("active");
        var index = $(this).index();
        $(".table-container table").eq(index).addClass("active").siblings().removeClass("active");
    });
    //////////

    function openUrl(url, title,width) {
        if (url && url != "")
            openWindow(url, { "width": width||"80%", "title": title, addQueryString: false });
    }

    function LinkToCost(costType,subjectCode) {
        var url = '/Market/Analysis/ProjectAnalysis/CostItemSummaryList';
        var width = 600; var height = "80%";var title="项目支出";
        var queryData = {"$EQ$ProjectID":MarketProjectInfoID};
        if(costType)
        {
            queryData["$EQ$CostType"] = costType;
            title="报销支出";
        }
        if(subjectCode)
        {
            url = "/MvcConfig/UI/List/PageView?TmplCode=ProjectCostDetail";
            width = "70%"; height = "75%";
            queryData["$EQ$SubjectCode"] = subjectCode;
            title="分包支出";
        }
        openWindow(url, { data: queryData, width: width, height: height,title:title });
    }

</script>

<style type="text/css">
    .timeline {
        list-style-type: none;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: rgba(255,255,255,1) !important;
        height: 120px;
        border-radius: 7px;
        font-size: 13px;
    }

    .timestamp {
        margin-bottom: 20px;
        padding: 0px 30px;
        display: flex;
        flex-direction: column;
        align-items: center;
        font-weight: 100;
        text-align: left;
    }


    .status {
        padding: 0px 40px;
        display: flex;
        justify-content: center;
        border-top: 2px solid #D6DCE0;
        position: relative;
        transition: all 200ms ease-in;
    }

        .status:before {
            content: "";
            width: 25px;
            height: 25px;
            background-color: white;
            border-radius: 25px;
            border: 1px solid #ddd;
            position: absolute;
            top: -15px;
            left: 42%;
            transition: all 200ms ease-in;
        }


        .status h4 {
            font-weight: 600;
            margin: 20px;
        }

    .li.relay .status {
        border-top: 2px solid #FFD700;
    }


    .li.complete .status {
        border-top: 2px solid #66DC71;
    }

        .li.complete .status:before {
            background-color: #66DC71;
            border: none;
            transition: all 200ms ease-in;
        }


    .li.relay .status:before {
        background-color: #FFD700;
        border: none;
        transition: all 200ms ease-in;
    }

    li {
        display: list-item;
    }

    .li {
        transition: all 200ms ease-in;
    }
</style>
